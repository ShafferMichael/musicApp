# Sprint 3

### Date: 2023-03-29

## Frontend work update:

- Updated the UI with animations for "Link Spotify" and "Login" buttons, a banner with our name, and a color scheme with Spotify green and blue.
- Added normalize.css for cross-platform compatibility.
- Updated spotifyservices.ts with comments and reordered functions, and fixed bugs with the login function.
- Added environment.ts to hold client ID and client secret from Spotify for future routing solutions.
- Added TODOs for easier tracking using vscode extensions.
- Created a dualwindow branch to separate the current login.component.ts into two components for better code organization
- Animated the login button like an equalizer to keep the user entertained while waiting for the login to complete.
- Updated the angular routing to add a home component

## Frontend work to do:
- Finish separating login.component.ts into two components.
- Fix bugs with some buttons and continue styling 

## Backend work update:
- Implemented delete method for users and groups which uses the ID to search for and delete certain documents from the database
- Fixed duplicate users bug by checking for pre-existing user in database before allowing for the creation of new one
- Implemented the put request for Users which allows frontend to change specific fields from a given user without modifying anything else
## Backend work to do:
- Compute how songs in the group category will be updated based on the user's preferences, and by what metric it will changed from semi-matched to matched

## Unit Test:
### Frontend:
- 
### Backend:
- Same Unit test as previous sprint
- Addition of unit tests for new DeleteUser and DeleteGroup which makes sure that the total number of users is one less than what it was after deleteing 
- Addition of unit test for PutUser, which makes sure that the fields of a user are properly updated after a put request updating a user

# Documentation for backend:

Added functionality for user and group information and making it more efficient to access the information.

Group Struct:
Model for a group object, which holds:
- a unique GroupID string for identification
- a slice of strings which holds userIDs for users in the group
- a playlistID string which stores the ID for the playlist made by the group
- a map named SemiMatched which contains stores song IDs for they key, and the ratio of
users in the group who like the song divided by the number of users in the group
- a map named Matched which contains stores song IDs for they key, and the ratio of
users in the group who like the song divided by the number of users in the group
- when the ratio of likes/users in SemiMatched goes above a certain threshold, the song is
removed from SemiMatched and added to Matched, meaning a significant amount of users in the
group like the song.

User Struct:
structure for user containing friends, liked songs and user id
friends and likedsong should contain an array of strings and userID should be a string
Friends is a list of all of the friends of a user on the platform
LikedSong is a list of all of the songs that a user has liked on the platform using the Tinder UI (swiping right)
UserID is the unique identifier of a user that is generated by the platform
GroupAdmin is a map of all of the groups that a user is an admin of and a boolean value that is true if the user is an admin of the group


GroupRepository Save:
The Save method in GroupRepostitory takes a group object input
and adds the group to the group collection in the firestore database

GroupRepository FindAll():
The FindAll method in GroupRepository takes no input and returns a string of group objects which are collected from the groups collection in firebase.This method uses the convertToStringSlice and convertToMap functions to convert the interface type used by firebase into slices and maps that match the type of the fields in the group model.

GroupRepository FindGroup():
The FindGroup method in GroupRepository takes in a groupID input and then searches the collection of groups in firestore to check for matching ID. Then it returns a group object with the contents of the correspoding document in firestore. However, since the groupID is already known as it is used to search, the returned object groupID is the document ID for the group in firebase.

UserRepository Save():
The Save method opens up a Firestore client, creates a new user in the users collection and returns the user object after it has been saved to the database

UserRepository FindUser():
The FindUser method opens up a Firestore client, gets the user with the given userID and returns the user object
It looks for the user with the given userID in the users collection by comparing all of the userID's to the given ID

UserRepository FindAll():
The FindAll method opens up a Firestore client, gets all of the users in the users collection and returns a slice of user objects which contain all of the users in the database. It uses a helper function convertToStringSlice to convert the Friends and LikedSong fields from interface{} to []string and convertToMap to convert the GroupAdmin field from interface{} to map[string]bool

convertToStringSlice():
convertToStringSlice converts an interface{} slice to a []string slice
It returns an error if the input is not a []interface{} or if any of the elements are not strings

convertToMap():
convertToMap converts an interface{} map to a map[string]bool map
It returns an error if the input is not a map[string]interface{} or if any of the values are not bools

getGroups():
The getGroups function in route.go takes a response writer and request,
and then calls the FindAll method in groupRepository\groupPost-repo.go
to get all the groups in the group collection in the firestore database

getGroup():
The getGroup function in route.go takes a response writer and request,
and then calls the FindGroup method in groupRepository\groupPost-repo.go to get a specific group in the group collection in the firestore database

getUser():
getUser function gets a specific user using the userID.
It uses the FindUser method in the UserRepository interface to fetch the user from the Firestore database. If there is an error, it returns a 500 status code and an error message.

addGroups():
The addGroups function in route.go takes a response writer and request,
and then calls the Save method in groupRepository\groupPost-repo.go
to add a group to the group collection in the firestore database

getUsers():
The getUsers function gets all the users from the userRepo and returns them as a JSON array.
It uses the FindAll method in the UserRepository interface to fetch the users from the Firestore database.
If there is an error, it returns a 500 status code and an error message.

addUsers():
addUsers function adds a new user to the userRepo.
It uses the Save method in the UserRepository interface to save the user to the Firestore database.
If there is an error, it returns a 500 status code and an error message.****
